/*! For license information please see chunk-ZZR53QFZ.js.LICENSE.txt */
import{a as le}from"./chunk-RQI6QM4Q.js";import{a as Z}from"./chunk-D6NO7OEC.js";import{a as R}from"./chunk-QCBYIBZJ.js";import{f as _,i as se}from"./chunk-YIFABOF6.js";import{a as ae,b as v,d as $}from"./chunk-KDW4RGIR.js";import{a as e,b as ce,d as j}from"./chunk-V624RX7A.js";import{a as Q}from"./chunk-VZ2RFJ3P.js";var we={ROUNDED:0,MITERED:1,BEVELED:2},L=Object.freeze(we),g=[new e,new e],ge=new e,pe=new e,xe=new e,Se=new e,Te=new e,Ee=new e,Be=new e,Ce=new e,ze=new e,P=new e,W=new e,I={},ee=new ce;function Ae(e,t){let n=new Array(e.length);for(let r=0;r<e.length;r++){let a=e[r];ee=t.cartesianToCartographic(a,ee),n[r]=ee.height,e[r]=t.scaleToGeodeticSurface(a,a)}return n}function te(t,n,r,a){let o,l=t[0],i=t[1],c=e.angleBetween(l,i),s=Math.ceil(c/a),u=new Array(s);if(n===r){for(o=0;o<s;o++)u[o]=n;return u.push(r),u}let g=(r-n)/s;for(o=1;o<s;o++){let e=n+o*g;u[o]=e}return u[0]=n,u.push(r),u}var X=new e,Y=new e;function Oe(t,n,r,a){let o=new R(r,a),l=o.projectPointOntoPlane(e.add(r,t,X),X),i=o.projectPointOntoPlane(e.add(r,n,Y),Y),c=$.angleBetween(l,i);return i.x*l.y-i.y*l.x>=0?-c:c}var je=new e(-1,0,0),N=new v,De=new v,re=new j,Me=j.IDENTITY.clone(),ve=new e,Ne=new ae,ie=new e;function D(t,n,r,a,o,l,i,c){let s=ve,u=Ne;N=se.eastNorthUpToFixedFrame(t,o,N),s=v.multiplyByPointAsVector(N,je,s),s=e.normalize(s,s);let g=Oe(s,n,t,o);re=j.fromRotationZ(g,re),ie.z=l,N=v.multiplyTransformation(N,v.fromRotationTranslation(re,ie,De),N);let m=Me;m[0]=i;for(let t=0;t<c;t++)for(let t=0;t<r.length;t+=3)u=e.fromArray(r,t,u),u=j.multiplyByVector(m,u,u),u=v.multiplyByPoint(N,u,u),a.push(u.x,u.y,u.z);return a}var Ve=new e;function ne(t,n,r,a,o,l,i){for(let c=0;c<t.length;c+=3)a=D(e.fromArray(t,c,Ve),n,r,a,o,l[c/3],i,1);return a}function be(e,t){let n=e.length,r=new Array(6*n),a=0,o=t.x+t.width/2,l=t.y+t.height/2,i=e[0];r[a++]=i.x-o,r[a++]=0,r[a++]=i.y-l;for(let t=1;t<n;t++){i=e[t];let n=i.x-o,c=i.y-l;r[a++]=n,r[a++]=0,r[a++]=c,r[a++]=n,r[a++]=0,r[a++]=c}return i=e[0],r[a++]=i.x-o,r[a++]=0,r[a++]=i.y-l,r}function fe(e,t){let n=e.length,r=new Array(3*n),a=0,o=t.x+t.width/2,l=t.y+t.height/2;for(let t=0;t<n;t++)r[a++]=e[t].x-o,r[a++]=0,r[a++]=e[t].y-l;return r}var me=new _,ue=new e,he=new j;function ye(t,n,r,a,o,l,i,c,s,u){let g,m,f,y=e.angleBetween(e.subtract(n,t,P),e.subtract(r,t,W)),d=a===L.BEVELED?0:Math.ceil(y/Q.toRadians(5));if(g=o?j.fromQuaternion(_.fromAxisAngle(e.negate(t,P),y/(d+1),me),he):j.fromQuaternion(_.fromAxisAngle(t,y/(d+1),me),he),n=e.clone(n,ue),d>0){let r=u?2:1;for(let a=0;a<d;a++)n=j.multiplyByVector(g,n,n),m=e.subtract(n,t,P),m=e.normalize(m,m),o||(m=e.negate(m,m)),f=l.scaleToGeodeticSurface(n,W),i=D(f,m,c,i,l,s,1,r)}else m=e.subtract(n,t,P),m=e.normalize(m,m),o||(m=e.negate(m,m)),f=l.scaleToGeodeticSurface(n,W),i=D(f,m,c,i,l,s,1,1),r=e.clone(r,ue),m=e.subtract(r,t,P),m=e.normalize(m,m),o||(m=e.negate(m,m)),f=l.scaleToGeodeticSurface(r,W),i=D(f,m,c,i,l,s,1,1);return i}I.removeDuplicatesFromShape=function(e){let t=e.length,n=[];for(let r=t-1,a=0;a<t;r=a++){let t=e[r],o=e[a];$.equals(t,o)||n.push(o)}return n},I.angleIsGreaterThanPi=function(t,n,r,a){let o=new R(r,a),l=o.projectPointOntoPlane(e.add(r,t,X),X),i=o.projectPointOntoPlane(e.add(r,n,Y),Y);return i.x*l.y-i.y*l.x>=0};var Fe=new e,Ge=new e;I.computePositions=function(t,n,r,a,o){let l=a._ellipsoid,i=Ae(t,l),c=a._granularity,s=a._cornerType,u=o?be(n,r):fe(n,r),m=o?fe(n,r):void 0,f=r.height/2,y=r.width/2,d=t.length,h=[],p=o?[]:void 0,w=ge,B=pe,j=xe,E=Se,v=Te,A=Ee,N=Be,x=Ce,z=ze,S=t[0],b=t[1];E=l.geodeticSurfaceNormal(S,E),w=e.subtract(b,S,w),w=e.normalize(w,w),x=e.cross(E,w,x),x=e.normalize(x,x);let T,R,O=i[0],V=i[1];o&&(p=D(S,x,m,p,l,O+f,1,1)),z=e.clone(S,z),S=b,B=e.negate(w,B);for(let n=1;n<d-1;n++){let r=o?2:1;if(b=t[n+1],S.equals(b)){le("Positions are too close and are considered equivalent with rounding error.");continue}w=e.subtract(b,S,w),w=e.normalize(w,w),j=e.add(w,B,j),j=e.normalize(j,j),E=l.geodeticSurfaceNormal(S,E);let a=e.multiplyByScalar(E,e.dot(w,E),Fe);e.subtract(w,a,a),e.normalize(a,a);let m=e.multiplyByScalar(E,e.dot(B,E),Ge);if(e.subtract(B,m,m),e.normalize(m,m),Q.equalsEpsilon(Math.abs(e.dot(a,m)),1,Q.EPSILON7))h=D(z,x,u,h,l,O+f,1,1),z=S;else{j=e.cross(j,E,j),j=e.cross(E,j,j),j=e.normalize(j,j);let t=1/Math.max(.25,e.magnitude(e.cross(j,B,P))),n=I.angleIsGreaterThanPi(w,B,S,l);n?(v=e.add(S,e.multiplyByScalar(j,t*y,j),v),A=e.add(v,e.multiplyByScalar(x,y,A),A),g[0]=e.clone(z,g[0]),g[1]=e.clone(A,g[1]),T=te(g,O+f,V+f,c),R=Z.generateArc({positions:g,granularity:c,ellipsoid:l}),h=ne(R,x,u,h,l,T,1),x=e.cross(E,w,x),x=e.normalize(x,x),N=e.add(v,e.multiplyByScalar(x,y,N),N),s===L.ROUNDED||s===L.BEVELED?ye(v,A,N,s,n,l,h,u,V+f,o):(j=e.negate(j,j),h=D(S,j,u,h,l,V+f,t,r)),z=e.clone(N,z)):(v=e.add(S,e.multiplyByScalar(j,t*y,j),v),A=e.add(v,e.multiplyByScalar(x,-y,A),A),g[0]=e.clone(z,g[0]),g[1]=e.clone(A,g[1]),T=te(g,O+f,V+f,c),R=Z.generateArc({positions:g,granularity:c,ellipsoid:l}),h=ne(R,x,u,h,l,T,1),x=e.cross(E,w,x),x=e.normalize(x,x),N=e.add(v,e.multiplyByScalar(x,-y,N),N),s===L.ROUNDED||s===L.BEVELED?ye(v,A,N,s,n,l,h,u,V+f,o):h=D(S,j,u,h,l,V+f,t,r),z=e.clone(N,z)),B=e.negate(w,B)}O=V,V=i[n+1],S=b}g[0]=e.clone(z,g[0]),g[1]=e.clone(S,g[1]),T=te(g,O+f,V+f,c),R=Z.generateArc({positions:g,granularity:c,ellipsoid:l}),h=ne(R,x,u,h,l,T,1),o&&(p=D(S,x,m,p,l,V+f,1,1)),d=h.length;let F=o?d+p.length:d,G=new Float64Array(F);return G.set(h),o&&G.set(p,d),G};var $e=I;export{L as a,$e as b};