/*! For license information please see chunk-KW7R7J2E.js.LICENSE.txt */
import{f as C}from"./chunk-YIFABOF6.js";import{a as n,d as b}from"./chunk-V624RX7A.js";import{a as w}from"./chunk-VZ2RFJ3P.js";var j={},q=new n,L=new n,Q=new C,G=new b;function W(t,e,r,a,o,i,l,s,y,c){let m=t+e;n.multiplyByScalar(a,Math.cos(m),q),n.multiplyByScalar(r,Math.sin(m),L),n.add(q,L,q);let u=Math.cos(t);u*=u;let w=Math.sin(t);w*=w;let x=i/Math.sqrt(l*u+o*w)/s;return C.fromAxisAngle(q,x,Q),b.fromQuaternion(Q,G),b.multiplyByVector(G,y,c),n.normalize(c,c),n.multiplyByScalar(c,s,c),c}var U=new n,Z=new n,N=new n,v=new n;j.raisePositionsToHeight=function(t,e,r){let a=e.ellipsoid,o=e.height,i=e.extrudedHeight,l=r?t.length/3*2:t.length/3,s=new Float64Array(3*l),y=t.length,c=r?y:0;for(let e=0;e<y;e+=3){let l=e+1,y=e+2,m=n.fromArray(t,e,U);a.scaleToGeodeticSurface(m,m);let u=n.clone(m,Z),w=a.geodeticSurfaceNormal(m,v),x=n.multiplyByScalar(w,o,N);n.add(m,x,m),r&&(n.multiplyByScalar(w,i,x),n.add(u,x,u),s[e+c]=u.x,s[l+c]=u.y,s[y+c]=u.z),s[e]=m.x,s[l]=m.y,s[y]=m.z}return s};var D=new n,J=new n,K=new n;j.computeEllipsePositions=function(t,e,r){let a=t.semiMinorAxis,o=t.semiMajorAxis,i=t.rotation,l=t.center,s=8*t.granularity,y=a*a,c=o*o,m=o*a,u=n.magnitude(l),x=n.normalize(l,D),h=n.cross(n.UNIT_Z,l,J);h=n.normalize(h,h);let f=n.cross(x,h,K),z=1+Math.ceil(w.PI_OVER_TWO/s),O=w.PI_OVER_TWO/(z-1),_=w.PI_OVER_TWO-z*O;_<0&&(z-=Math.ceil(Math.abs(_)/O));let p,d,P,I,M,T=e?new Array(z*(z+2)*2*3):void 0,V=0,g=U,A=Z,R=4*z*3,E=R-1,j=0,v=r?new Array(R):void 0;for(_=w.PI_OVER_TWO,g=W(_,i,f,h,y,m,c,u,x,g),e&&(T[V++]=g.x,T[V++]=g.y,T[V++]=g.z),r&&(v[E--]=g.z,v[E--]=g.y,v[E--]=g.x),_=w.PI_OVER_TWO-O,p=1;p<z+1;++p){if(g=W(_,i,f,h,y,m,c,u,x,g),A=W(Math.PI-_,i,f,h,y,m,c,u,x,A),e){for(T[V++]=g.x,T[V++]=g.y,T[V++]=g.z,P=2*p+2,d=1;d<P-1;++d)I=d/(P-1),M=n.lerp(g,A,I,N),T[V++]=M.x,T[V++]=M.y,T[V++]=M.z;T[V++]=A.x,T[V++]=A.y,T[V++]=A.z}r&&(v[E--]=g.z,v[E--]=g.y,v[E--]=g.x,v[j++]=A.x,v[j++]=A.y,v[j++]=A.z),_=w.PI_OVER_TWO-(p+1)*O}for(p=z;p>1;--p){if(_=w.PI_OVER_TWO-(p-1)*O,g=W(-_,i,f,h,y,m,c,u,x,g),A=W(_+Math.PI,i,f,h,y,m,c,u,x,A),e){for(T[V++]=g.x,T[V++]=g.y,T[V++]=g.z,P=2*(p-1)+2,d=1;d<P-1;++d)I=d/(P-1),M=n.lerp(g,A,I,N),T[V++]=M.x,T[V++]=M.y,T[V++]=M.z;T[V++]=A.x,T[V++]=A.y,T[V++]=A.z}r&&(v[E--]=g.z,v[E--]=g.y,v[E--]=g.x,v[j++]=A.x,v[j++]=A.y,v[j++]=A.z)}_=w.PI_OVER_TWO,g=W(-_,i,f,h,y,m,c,u,x,g);let B={};return e&&(T[V++]=g.x,T[V++]=g.y,T[V++]=g.z,B.positions=T,B.numPts=z),r&&(v[E--]=g.z,v[E--]=g.y,v[E--]=g.x,B.outerPositions=v),B};var tt=j;export{tt as a};