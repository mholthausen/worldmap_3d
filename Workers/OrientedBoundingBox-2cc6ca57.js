define(["exports","./Transforms-1142ce48","./Cartesian2-08065eec","./Check-be2d5acb","./when-ad3237a0","./EllipsoidTangentPlane-f8b1fc8b","./Math-5ca9b250","./Plane-bb88dd7e"],(function(a,t,e,n,r,i,s,o){"use strict";function C(a,n){this.center=e.Cartesian3.clone(r.defaultValue(a,e.Cartesian3.ZERO)),this.halfAxes=t.Matrix3.clone(r.defaultValue(n,t.Matrix3.ZERO))}C.packedLength=e.Cartesian3.packedLength+t.Matrix3.packedLength,C.pack=function(a,n,i){return i=r.defaultValue(i,0),e.Cartesian3.pack(a.center,n,i),t.Matrix3.pack(a.halfAxes,n,i+e.Cartesian3.packedLength),n},C.unpack=function(a,n,i){return n=r.defaultValue(n,0),r.defined(i)||(i=new C),e.Cartesian3.unpack(a,n,i.center),t.Matrix3.unpack(a,n+e.Cartesian3.packedLength,i.halfAxes),i};var c=new e.Cartesian3,u=new e.Cartesian3,d=new e.Cartesian3,l=new e.Cartesian3,h=new e.Cartesian3,x=new e.Cartesian3,M=new t.Matrix3,m={unitary:new t.Matrix3,diagonal:new t.Matrix3};C.fromPoints=function(a,n){if(r.defined(n)||(n=new C),!r.defined(a)||0===a.length)return n.halfAxes=t.Matrix3.ZERO,n.center=e.Cartesian3.ZERO,n;for(var i=a.length,s=e.Cartesian3.clone(a[0],c),o=1;o<i;o++)e.Cartesian3.add(s,a[o],s);var f=1/i;e.Cartesian3.multiplyByScalar(s,f,s);var p,g=0,w=0,y=0,b=0,N=0,O=0;for(o=0;o<i;o++)g+=(p=e.Cartesian3.subtract(a[o],s,u)).x*p.x,w+=p.x*p.y,y+=p.x*p.z,b+=p.y*p.y,N+=p.y*p.z,O+=p.z*p.z;w*=f,y*=f,b*=f,N*=f,O*=f,(P=M)[0]=g*=f,P[1]=w,P[2]=y,P[3]=w,P[4]=b,P[5]=N,P[6]=y,P[7]=N,P[8]=O;var P=t.Matrix3.computeEigenDecomposition(P,m),T=(P=t.Matrix3.clone(P.unitary,n.halfAxes),t.Matrix3.getColumn(P,0,l)),A=t.Matrix3.getColumn(P,1,h),I=t.Matrix3.getColumn(P,2,x),R=-Number.MAX_VALUE,E=-Number.MAX_VALUE,S=-Number.MAX_VALUE,U=Number.MAX_VALUE,L=Number.MAX_VALUE,z=Number.MAX_VALUE;for(o=0;o<i;o++)p=a[o],R=Math.max(e.Cartesian3.dot(T,p),R),E=Math.max(e.Cartesian3.dot(A,p),E),S=Math.max(e.Cartesian3.dot(I,p),S),U=Math.min(e.Cartesian3.dot(T,p),U),L=Math.min(e.Cartesian3.dot(A,p),L),z=Math.min(e.Cartesian3.dot(I,p),z);return T=e.Cartesian3.multiplyByScalar(T,.5*(U+R),T),A=e.Cartesian3.multiplyByScalar(A,.5*(L+E),A),I=e.Cartesian3.multiplyByScalar(I,.5*(z+S),I),P=e.Cartesian3.add(T,A,n.center),e.Cartesian3.add(P,I,P),(P=d).x=R-U,P.y=E-L,P.z=S-z,e.Cartesian3.multiplyByScalar(P,.5,P),t.Matrix3.multiplyByScale(n.halfAxes,P,n.halfAxes),n};var f=new e.Cartesian3,p=new e.Cartesian3;function g(a,n,i,s,o,c,u,d,l,h,x){var M=(x=r.defined(x)?x:new C).halfAxes;return t.Matrix3.setColumn(M,0,n,M),t.Matrix3.setColumn(M,1,i,M),t.Matrix3.setColumn(M,2,s,M),(i=f).x=(o+c)/2,i.y=(u+d)/2,i.z=(l+h)/2,(s=p).x=(c-o)/2,s.y=(d-u)/2,s.z=(h-l)/2,l=x.center,i=t.Matrix3.multiplyByVector(M,i,i),e.Cartesian3.add(a,i,l),t.Matrix3.multiplyByScale(M,s,M),x}var w=new e.Cartographic,y=new e.Cartesian3,b=new e.Cartographic,N=new e.Cartographic,O=new e.Cartographic,P=new e.Cartographic,T=new e.Cartographic,A=new e.Cartesian3,I=new e.Cartesian3,R=new e.Cartesian3,E=new e.Cartesian3,S=new e.Cartesian3,U=new e.Cartesian2,L=new e.Cartesian2,z=new e.Cartesian2,v=new e.Cartesian2,B=new e.Cartesian2,V=new e.Cartesian3,_=new e.Cartesian3,k=new e.Cartesian3,W=new e.Cartesian3,X=new e.Cartesian2,q=new e.Cartesian3,D=new e.Cartesian3,j=new e.Cartesian3,Z=new o.Plane(e.Cartesian3.UNIT_X,0);C.fromRectangle=function(a,t,n,C,c){if(t=r.defaultValue(t,0),n=r.defaultValue(n,0),C=r.defaultValue(C,e.Ellipsoid.WGS84),a.width<=s.CesiumMath.PI){var u=e.Rectangle.center(a,w),d=C.cartographicToCartesian(u,y),l=new i.EllipsoidTangentPlane(d,C),h=l.plane,x=u.longitude,M=a.south<0&&0<a.north?0:u.latitude,m=e.Cartographic.fromRadians(x,a.north,n,b),f=e.Cartographic.fromRadians(a.west,a.north,n,N),p=e.Cartographic.fromRadians(a.west,M,n,O),Y=e.Cartographic.fromRadians(a.west,a.south,n,P),G=e.Cartographic.fromRadians(x,a.south,n,T),F=C.cartographicToCartesian(m,A),H=C.cartographicToCartesian(f,I),J=C.cartographicToCartesian(p,R),K=C.cartographicToCartesian(Y,E);return d=C.cartographicToCartesian(G,S),u=l.projectPointToNearestOnPlane(F,U),M=l.projectPointToNearestOnPlane(H,L),x=l.projectPointToNearestOnPlane(J,z),m=l.projectPointToNearestOnPlane(K,v),p=l.projectPointToNearestOnPlane(d,B),F=-(G=Math.min(M.x,x.x,m.x)),J=Math.max(M.y,u.y),d=Math.min(m.y,p.y),f.height=Y.height=t,H=C.cartographicToCartesian(f,I),K=C.cartographicToCartesian(Y,E),x=Math.min(o.Plane.getPointDistance(h,H),o.Plane.getPointDistance(h,K)),M=n,g(l.origin,l.xAxis,l.yAxis,l.zAxis,G,F,d,J,x,M,c)}return u=0<a.south,m=a.north<0,p=u?a.south:m?a.north:0,f=e.Rectangle.center(a,w).longitude,(Y=e.Cartesian3.fromRadians(f,p,n,C,V)).z=0,H=Math.abs(Y.x)<s.CesiumMath.EPSILON10&&Math.abs(Y.y)<s.CesiumMath.EPSILON10?e.Cartesian3.UNIT_X:e.Cartesian3.normalize(Y,_),K=e.Cartesian3.UNIT_Z,l=e.Cartesian3.cross(H,K,k),h=o.Plane.fromPointNormal(Y,H,Z),f=e.Cartesian3.fromRadians(f+s.CesiumMath.PI_OVER_TWO,p,n,C,W),G=-(F=e.Cartesian3.dot(o.Plane.projectPointOntoPlane(h,f,X),l)),J=e.Cartesian3.fromRadians(0,a.north,m?t:n,C,q).z,d=e.Cartesian3.fromRadians(0,a.south,u?t:n,C,D).z,C=e.Cartesian3.fromRadians(a.east,p,n,C,j),g(Y,l,K,H,G,F,d,J,x=o.Plane.getPointDistance(h,C),M=0,c)},C.clone=function(a,n){if(r.defined(a))return r.defined(n)?(e.Cartesian3.clone(a.center,n.center),t.Matrix3.clone(a.halfAxes,n.halfAxes),n):new C(a.center,a.halfAxes)},C.intersectPlane=function(a,n){var r=a.center,i=n.normal,s=a.halfAxes,o=i.x,C=i.y;return a=i.z,s=Math.abs(o*s[t.Matrix3.COLUMN0ROW0]+C*s[t.Matrix3.COLUMN0ROW1]+a*s[t.Matrix3.COLUMN0ROW2])+Math.abs(o*s[t.Matrix3.COLUMN1ROW0]+C*s[t.Matrix3.COLUMN1ROW1]+a*s[t.Matrix3.COLUMN1ROW2])+Math.abs(o*s[t.Matrix3.COLUMN2ROW0]+C*s[t.Matrix3.COLUMN2ROW1]+a*s[t.Matrix3.COLUMN2ROW2]),(n=e.Cartesian3.dot(i,r)+n.distance)<=-s?t.Intersect.OUTSIDE:s<=n?t.Intersect.INSIDE:t.Intersect.INTERSECTING};var Y=new e.Cartesian3,G=new e.Cartesian3,F=new e.Cartesian3,H=new e.Cartesian3,J=new e.Cartesian3,K=new e.Cartesian3;C.distanceSquaredTo=function(a,n){var r,i,o,C,c=e.Cartesian3.subtract(n,a.center,f),u=a.halfAxes,d=t.Matrix3.getColumn(u,0,Y),l=t.Matrix3.getColumn(u,1,G),h=t.Matrix3.getColumn(u,2,F),x=e.Cartesian3.magnitude(d),M=e.Cartesian3.magnitude(l),m=e.Cartesian3.magnitude(h),p=!0;return n=!0,a=!0,0<x?e.Cartesian3.divideByScalar(d,x,d):p=!1,0<M?e.Cartesian3.divideByScalar(l,M,l):n=!1,0<m?e.Cartesian3.divideByScalar(h,m,h):a=!1,1==(u=!p+!n+!a)?(p=d,i=l,o=h,n?a||(p=h,o=d):(p=l,i=d),r=e.Cartesian3.cross(i,o,J),p===d?d=r:p===l?l=r:p===h&&(h=r)):2==u?(i=d,n?i=l:a&&(i=h),(a=e.Cartesian3.UNIT_Y).equalsEpsilon(i,s.CesiumMath.EPSILON3)&&(a=e.Cartesian3.UNIT_X),o=e.Cartesian3.cross(i,a,H),e.Cartesian3.normalize(o,o),r=e.Cartesian3.cross(i,o,J),e.Cartesian3.normalize(r,r),i===d?(l=o,h=r):i===l?(h=o,d=r):i===h&&(d=o,l=r)):3==u&&(d=e.Cartesian3.UNIT_X,l=e.Cartesian3.UNIT_Y,h=e.Cartesian3.UNIT_Z),(u=K).x=e.Cartesian3.dot(c,d),u.y=e.Cartesian3.dot(c,l),u.z=e.Cartesian3.dot(c,h),h=0,u.x<-x?h+=(C=u.x+x)*C:u.x>x&&(h+=(C=u.x-x)*C),u.y<-M?h+=(C=u.y+M)*C:u.y>M&&(h+=(C=u.y-M)*C),u.z<-m?h+=(C=u.z+m)*C:u.z>m&&(h+=(C=u.z-m)*C),h};var Q=new e.Cartesian3,$=new e.Cartesian3;C.computePlaneDistances=function(a,n,i,s){r.defined(s)||(s=new t.Interval);var o=Number.POSITIVE_INFINITY,C=Number.NEGATIVE_INFINITY,c=a.center,u=a.halfAxes,d=t.Matrix3.getColumn(u,0,Y),l=t.Matrix3.getColumn(u,1,G),h=t.Matrix3.getColumn(u,2,F),x=e.Cartesian3.add(d,l,Q);return e.Cartesian3.add(x,h,x),e.Cartesian3.add(x,c,x),a=e.Cartesian3.subtract(x,n,$),u=e.Cartesian3.dot(i,a),o=Math.min(u,o),C=Math.max(u,C),e.Cartesian3.add(c,d,x),e.Cartesian3.add(x,l,x),e.Cartesian3.subtract(x,h,x),e.Cartesian3.subtract(x,n,a),u=e.Cartesian3.dot(i,a),o=Math.min(u,o),C=Math.max(u,C),e.Cartesian3.add(c,d,x),e.Cartesian3.subtract(x,l,x),e.Cartesian3.add(x,h,x),e.Cartesian3.subtract(x,n,a),u=e.Cartesian3.dot(i,a),o=Math.min(u,o),C=Math.max(u,C),e.Cartesian3.add(c,d,x),e.Cartesian3.subtract(x,l,x),e.Cartesian3.subtract(x,h,x),e.Cartesian3.subtract(x,n,a),u=e.Cartesian3.dot(i,a),o=Math.min(u,o),C=Math.max(u,C),e.Cartesian3.subtract(c,d,x),e.Cartesian3.add(x,l,x),e.Cartesian3.add(x,h,x),e.Cartesian3.subtract(x,n,a),u=e.Cartesian3.dot(i,a),o=Math.min(u,o),C=Math.max(u,C),e.Cartesian3.subtract(c,d,x),e.Cartesian3.add(x,l,x),e.Cartesian3.subtract(x,h,x),e.Cartesian3.subtract(x,n,a),u=e.Cartesian3.dot(i,a),o=Math.min(u,o),C=Math.max(u,C),e.Cartesian3.subtract(c,d,x),e.Cartesian3.subtract(x,l,x),e.Cartesian3.add(x,h,x),e.Cartesian3.subtract(x,n,a),u=e.Cartesian3.dot(i,a),o=Math.min(u,o),C=Math.max(u,C),e.Cartesian3.subtract(c,d,x),e.Cartesian3.subtract(x,l,x),e.Cartesian3.subtract(x,h,x),e.Cartesian3.subtract(x,n,a),u=e.Cartesian3.dot(i,a),o=Math.min(u,o),C=Math.max(u,C),s.start=o,s.stop=C,s};var aa=new t.BoundingSphere;C.isOccluded=function(a,e){return a=t.BoundingSphere.fromOrientedBoundingBox(a,aa),!e.isBoundingSphereVisible(a)},C.prototype.intersectPlane=function(a){return C.intersectPlane(this,a)},C.prototype.distanceSquaredTo=function(a){return C.distanceSquaredTo(this,a)},C.prototype.computePlaneDistances=function(a,t,e){return C.computePlaneDistances(this,a,t,e)},C.prototype.isOccluded=function(a){return C.isOccluded(this,a)},C.equals=function(a,n){return a===n||r.defined(a)&&r.defined(n)&&e.Cartesian3.equals(a.center,n.center)&&t.Matrix3.equals(a.halfAxes,n.halfAxes)},C.prototype.clone=function(a){return C.clone(this,a)},C.prototype.equals=function(a){return C.equals(this,a)},a.OrientedBoundingBox=C}));