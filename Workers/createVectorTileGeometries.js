define(["./Transforms-1142ce48","./BoxGeometry-e711991b","./Cartesian2-08065eec","./Color-5f48ac7a","./CylinderGeometry-f46c3967","./when-ad3237a0","./EllipsoidGeometry-3051a04d","./IndexDatatype-9504f550","./createTaskProcessorWorker","./Check-be2d5acb","./Math-5ca9b250","./combine-1510933d","./RuntimeError-767bd866","./GeometryOffsetAttribute-03006e80","./ComponentDatatype-a867ddaa","./WebGLConstants-1c8239cc","./GeometryAttribute-da891979","./GeometryAttributes-27dc652d","./VertexFormat-fc4fc84a","./CylinderGeometryLibrary-913928ca"],(function(e,t,n,a,r,i,o,d,s,c,f,l,u,h,p,b,y,x,g,C){"use strict";function m(e){this.offset=e.offset,this.count=e.count,this.color=e.color,this.batchIds=e.batchIds}var v=new n.Cartesian3,I=e.Matrix4.packedLength+n.Cartesian3.packedLength,k=e.Matrix4.packedLength+2,M=e.Matrix4.packedLength+n.Cartesian3.packedLength,B=n.Cartesian3.packedLength+1,w={modelMatrix:new e.Matrix4,boundingVolume:new e.BoundingSphere};function A(t,a){var r=a*I;return a=n.Cartesian3.unpack(t,r,v),r+=n.Cartesian3.packedLength,r=e.Matrix4.unpack(t,r,w.modelMatrix),e.Matrix4.multiplyByScale(r,a,r),r=w.boundingVolume,n.Cartesian3.clone(n.Cartesian3.ZERO,r.center),r.radius=Math.sqrt(3),w}function O(t,a){var r=a*k,i=t[r++];return a=t[r++],a=n.Cartesian3.fromElements(i,i,a,v),r=e.Matrix4.unpack(t,r,w.modelMatrix),e.Matrix4.multiplyByScale(r,a,r),r=w.boundingVolume,n.Cartesian3.clone(n.Cartesian3.ZERO,r.center),r.radius=Math.sqrt(2),w}function L(t,a){var r=a*M;return a=n.Cartesian3.unpack(t,r,v),r+=n.Cartesian3.packedLength,r=e.Matrix4.unpack(t,r,w.modelMatrix),e.Matrix4.multiplyByScale(r,a,r),r=w.boundingVolume,n.Cartesian3.clone(n.Cartesian3.ZERO,r.center),r.radius=1,w}function E(t,a){var r=a*B;return a=t[r++],r=n.Cartesian3.unpack(t,r,v),r=e.Matrix4.fromTranslation(r,w.modelMatrix),e.Matrix4.multiplyByUniformScale(r,a,r),r=w.boundingVolume,n.Cartesian3.clone(n.Cartesian3.ZERO,r.center),r.radius=1,w}var U=new n.Cartesian3;function G(t,r,o,d,s){if(i.defined(r)){for(var c=o.length,f=d.attributes.position.values,l=d.indices,u=t.positions,h=t.vertexBatchIds,p=t.indices,b=t.batchIds,y=t.batchTableColors,x=t.batchedIndices,g=t.indexOffsets,C=t.indexCounts,v=t.boundingVolumes,I=t.modelMatrix,k=t.center,M=t.positionOffset,B=t.batchIdIndex,w=t.indexOffset,A=t.batchedIndicesOffset,O=0;O<c;++O){var L=s(r,O),E=L.modelMatrix;e.Matrix4.multiply(I,E,E);for(var G=o[O],S=f.length,T=0;T<S;T+=3){var V=n.Cartesian3.unpack(f,T,U);e.Matrix4.multiplyByPoint(E,V,V),n.Cartesian3.subtract(V,k,V),n.Cartesian3.pack(V,u,3*M+T),h[B++]=G}for(var F=l.length,R=0;R<F;++R)p[w+R]=l[R]+M;var Z=O+A;x[Z]=new m({offset:w,count:F,color:a.Color.fromRgba(y[G]),batchIds:[G]}),b[Z]=G,g[Z]=w,C[Z]=F,v[Z]=e.BoundingSphere.transform(L.boundingVolume,E),M+=S/3,w+=F}t.positionOffset=M,t.batchIdIndex=B,t.indexOffset=w,t.batchedIndicesOffset+=c}}var S=new n.Cartesian3,T=new e.Matrix4;return s((function(s,c){var f=i.defined(s.boxes)?new Float32Array(s.boxes):void 0,l=i.defined(s.boxBatchIds)?new Uint16Array(s.boxBatchIds):void 0,u=i.defined(s.cylinders)?new Float32Array(s.cylinders):void 0,h=i.defined(s.cylinderBatchIds)?new Uint16Array(s.cylinderBatchIds):void 0,p=i.defined(s.ellipsoids)?new Float32Array(s.ellipsoids):void 0,b=i.defined(s.ellipsoidBatchIds)?new Uint16Array(s.ellipsoidBatchIds):void 0,y=i.defined(s.spheres)?new Float32Array(s.spheres):void 0,x=i.defined(s.sphereBatchIds)?new Uint16Array(s.sphereBatchIds):void 0,g=i.defined(f)?l.length:0,C=i.defined(u)?h.length:0,m=i.defined(p)?b.length:0,v=i.defined(y)?x.length:0,I=t.BoxGeometry.getUnitBox(),k=r.CylinderGeometry.getUnitCylinder(),M=o.EllipsoidGeometry.getUnitEllipsoid(),B=I.attributes.position.values,w=k.attributes.position.values,U=M.attributes.position.values,V=B.length*g;V+=w.length*C,V+=U.length*(m+v);var F=I.indices,R=k.indices;return B=M.indices,w=F.length*g,w+=R.length*C,w+=B.length*(m+v),U=new Float32Array(V),F=new Uint16Array(V/3),R=d.IndexDatatype.createTypedArray(V/3,w),B=g+C+m+v,V=new Uint16Array(B),w=new Array(B),g=new Uint32Array(B),C=new Uint32Array(B),m=new Array(B),v=s.packedBuffer,B=new Float64Array(v),v=0,n.Cartesian3.unpack(B,0,S),v+=n.Cartesian3.packedLength,e.Matrix4.unpack(B,v,T),G(s={batchTableColors:new Uint32Array(s.batchTableColors),positions:U,vertexBatchIds:F,indices:R,batchIds:V,batchedIndices:w,indexOffsets:g,indexCounts:C,boundingVolumes:m,positionOffset:0,batchIdIndex:0,indexOffset:0,batchedIndicesOffset:0,modelMatrix:T,center:S},f,l,I,A),G(s,u,h,k,O),G(s,p,b,M,L),G(s,y,x,M,E),m=function(t,n,r){var i=r.length,o=2+i*e.BoundingSphere.packedLength+1+function(e){for(var t=e.length,n=0,r=0;r<t;++r)n+=a.Color.packedLength+3+e[r].batchIds.length;return n}(n),d=new Float64Array(o),s=0;d[s++]=t,d[s++]=i;for(var c=0;c<i;++c)e.BoundingSphere.pack(r[c],d,s),s+=e.BoundingSphere.packedLength;var f=n.length;d[s++]=f;for(var l=0;l<f;++l){var u=n[l];a.Color.pack(u.color,d,s),s+=a.Color.packedLength,d[s++]=u.offset,d[s++]=u.count;var h=u.batchIds,p=h.length;d[s++]=p;for(var b=0;b<p;++b)d[s++]=h[b]}return d}(R.BYTES_PER_ELEMENT,w,m),c.push(U.buffer,F.buffer,R.buffer),c.push(V.buffer,g.buffer,C.buffer),c.push(m.buffer),{positions:U.buffer,vertexBatchIds:F.buffer,indices:R.buffer,indexOffsets:g.buffer,indexCounts:C.buffer,batchIds:V.buffer,packedBuffer:m.buffer}}))}));