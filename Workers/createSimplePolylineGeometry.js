define(["./when-ad3237a0","./Cartesian2-08065eec","./ArcType-98ec98bf","./Transforms-1142ce48","./Color-5f48ac7a","./ComponentDatatype-a867ddaa","./Check-be2d5acb","./GeometryAttribute-da891979","./GeometryAttributes-27dc652d","./IndexDatatype-9504f550","./Math-5ca9b250","./PolylinePipeline-05927ee2","./combine-1510933d","./RuntimeError-767bd866","./WebGLConstants-1c8239cc","./EllipsoidGeodesic-dc284f08","./EllipsoidRhumbLine-4a6ed5de","./IntersectionTests-75083888","./Plane-bb88dd7e"],(function(e,o,t,r,a,l,i,n,s,p,d,c,y,f,u,h,C,T,g){"use strict";function m(r){var l=(r=e.defaultValue(r,e.defaultValue.EMPTY_OBJECT)).positions,i=r.colors,n=e.defaultValue(r.colorsPerVertex,!1);this._positions=l,this._colors=i,this._colorsPerVertex=n,this._arcType=e.defaultValue(r.arcType,t.ArcType.GEODESIC),this._granularity=e.defaultValue(r.granularity,d.CesiumMath.RADIANS_PER_DEGREE),this._ellipsoid=e.defaultValue(r.ellipsoid,o.Ellipsoid.WGS84),this._workerName="createSimplePolylineGeometry",l=1+l.length*o.Cartesian3.packedLength,l+=e.defined(i)?1+i.length*a.Color.packedLength:1,this.packedLength=l+o.Ellipsoid.packedLength+3}m.pack=function(t,r,l){var i;l=e.defaultValue(l,0);var n=t._positions,s=n.length;for(r[l++]=s,i=0;i<s;++i,l+=o.Cartesian3.packedLength)o.Cartesian3.pack(n[i],r,l);var p=t._colors;for(s=e.defined(p)?p.length:0,r[l++]=s,i=0;i<s;++i,l+=a.Color.packedLength)a.Color.pack(p[i],r,l);return o.Ellipsoid.pack(t._ellipsoid,r,l),l+=o.Ellipsoid.packedLength,r[l++]=t._colorsPerVertex?1:0,r[l++]=t._arcType,r[l]=t._granularity,r},m.unpack=function(t,r,l){r=e.defaultValue(r,0);for(var i=t[r++],n=new Array(i),s=0;s<i;++s,r+=o.Cartesian3.packedLength)n[s]=o.Cartesian3.unpack(t,r);var p=0<(i=t[r++])?new Array(i):void 0;for(s=0;s<i;++s,r+=a.Color.packedLength)p[s]=a.Color.unpack(t,r);var d=o.Ellipsoid.unpack(t,r);r+=o.Ellipsoid.packedLength;var c=1===t[r++],y=t[r++],f=t[r];return e.defined(l)?(l._positions=n,l._colors=p,l._ellipsoid=d,l._colorsPerVertex=c,l._arcType=y,l._granularity=f,l):new m({positions:n,colors:p,ellipsoid:d,colorsPerVertex:c,arcType:y,granularity:f})};var b=new Array(2),P=new Array(2),_={positions:b,height:P,ellipsoid:void 0,minDistance:void 0,granularity:void 0};return m.createGeometry=function(i){var y=i._positions,f=i._colors,u=i._colorsPerVertex,h=i._arcType,C=i._granularity,T=(i=i._ellipsoid,d.CesiumMath.chordLength(C,i.maximumRadius)),g=e.defined(f)&&!u,m=y.length,v=0;if(h===t.ArcType.GEODESIC||h===t.ArcType.RHUMB){var B,A,E=h===t.ArcType.GEODESIC?(B=d.CesiumMath.chordLength(C,i.maximumRadius),A=c.PolylinePipeline.numberOfPoints,c.PolylinePipeline.generateArc):(B=C,A=c.PolylinePipeline.numberOfPointsRhumbLine,c.PolylinePipeline.generateRhumbArc),k=c.PolylinePipeline.extractHeights(y,i),G=_;if(h===t.ArcType.GEODESIC?G.minDistance=T:G.granularity=C,G.ellipsoid=i,g){for(var w=0,D=0;D<m-1;D++)w+=A(y[D],y[D+1],B)+1;M=new Float64Array(3*w),U=new Uint8Array(4*w),G.positions=b,G.height=P;var L=0;for(D=0;D<m-1;++D){b[0]=y[D],b[1]=y[D+1],P[0]=k[D],P[1]=k[D+1];var V=E(G);if(e.defined(f))for(var x=V.length/3,S=f[D],I=0;I<x;++I)U[L++]=a.Color.floatToByte(S.red),U[L++]=a.Color.floatToByte(S.green),U[L++]=a.Color.floatToByte(S.blue),U[L++]=a.Color.floatToByte(S.alpha);M.set(V,v),v+=V.length}}else if(G.positions=y,G.height=k,M=new Float64Array(E(G)),e.defined(f)){for(U=new Uint8Array(M.length/3*4),D=0;D<m-1;++D)v=function(e,o,t,r,l,i,n){var s=c.PolylinePipeline.numberOfPoints(e,o,l),p=t.red,d=t.green,y=t.blue,f=t.alpha,u=r.red;if(e=r.green,o=r.blue,l=r.alpha,a.Color.equals(t,r)){for(b=0;b<s;b++)i[n++]=a.Color.floatToByte(p),i[n++]=a.Color.floatToByte(d),i[n++]=a.Color.floatToByte(y),i[n++]=a.Color.floatToByte(f);return n}for(var h=(u-p)/s,C=(e-d)/s,T=(o-y)/s,g=(l-f)/s,m=n,b=0;b<s;b++)i[m++]=a.Color.floatToByte(p+b*h),i[m++]=a.Color.floatToByte(d+b*C),i[m++]=a.Color.floatToByte(y+b*T),i[m++]=a.Color.floatToByte(f+b*g);return m}(y[D],y[D+1],f[D],f[D+1],T,U,v);var R=f[m-1];U[v++]=a.Color.floatToByte(R.red),U[v++]=a.Color.floatToByte(R.green),U[v++]=a.Color.floatToByte(R.blue),U[v++]=a.Color.floatToByte(R.alpha)}}else{var O=g?2*m-2:m,M=new Float64Array(3*O),U=e.defined(f)?new Uint8Array(4*O):void 0,N=0,F=0;for(D=0;D<m;++D){var H=y[D];if(g&&0<D&&(o.Cartesian3.pack(H,M,N),N+=3,S=f[D-1],U[F++]=a.Color.floatToByte(S.red),U[F++]=a.Color.floatToByte(S.green),U[F++]=a.Color.floatToByte(S.blue),U[F++]=a.Color.floatToByte(S.alpha)),g&&D===m-1)break;o.Cartesian3.pack(H,M,N),N+=3,e.defined(f)&&(S=f[D],U[F++]=a.Color.floatToByte(S.red),U[F++]=a.Color.floatToByte(S.green),U[F++]=a.Color.floatToByte(S.blue),U[F++]=a.Color.floatToByte(S.alpha))}}(R=new s.GeometryAttributes).position=new n.GeometryAttribute({componentDatatype:l.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:M}),e.defined(f)&&(R.color=new n.GeometryAttribute({componentDatatype:l.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,values:U,normalize:!0})),O=M.length/3;var W=p.IndexDatatype.createTypedArray(O,2*(O-1)),Y=0;for(D=0;D<O-1;++D)W[Y++]=D,W[Y++]=D+1;return new n.Geometry({attributes:R,indices:W,primitiveType:n.PrimitiveType.LINES,boundingSphere:r.BoundingSphere.fromPoints(y)})},function(t,r){return(t=e.defined(r)?m.unpack(t,r):t)._ellipsoid=o.Ellipsoid.clone(t._ellipsoid),m.createGeometry(t)}}));